The design of FORT strictly separates the climate control from the vision in hardware and software. This improves the stability of the setup and facilitates the maintenance. On the highest level, **zeus** controls the climate and **leto** the vision/tracking.

# Tracking
The following chart explains the tracking software components.

<img alt="Tracking network" src="https://github.com/formicidae-tracker/documentation/raw/draft-matthias/images/sw_structure_vision.png" width="400" />

> Grey boxes represent components developed in the course of the FORT project, white boxes represent external components.

**leto** implements the tracking user interface. It deals with the network communication between master and slaves, and configures the lower level **artemis** instances. *.leto* files are used to configure a tracking experiment. TODO describe components of leto.

**artemis** implements to computer vision functionality that detects tags and extracts their ID, position and orientation. It builds on the **apriltag**, **OpenCV**, **hermes** and **protobuf** libraries.

**hermes** is a library that implements the communication protocol for tracking data. It uses the google **protobuf** framework for serialization. TODO explain hermes library to be used by setup PCs to retrieve data in real time.

The FORT vision system operates in infrared to allow tracking at night. Infrared flashlights at the pace of the frame rate are generated by the **helios** board (see below).

# Climate
The following chart explains the climate software and firmware components.

<img alt="Tracking network" src="https://github.com/formicidae-tracker/documentation/raw/draft-matthias/images/swfw_structure_climate.png" width="300" />
> Grey boxes represent components developed in the course of the FORT project, white boxes represent external components. Green shadowed boxes represent firmware

**zeus** is the top level component that orchestrates the climate control system. A *.season* file allows to program climate states and transitions such as day and night. The zeus host application (shown on top of the figure) loads the configuration and initiates the climate control by providing a climate set-point to the zeus board. **zeus-calibrator** (not shown) is a helper program on the host to infer climate sensor offsets on the board. To use it, at least one additional **anemoi** board must be connected to the I2C bus (see below).

**libarke** implements the climate specific communication protocol, that builds on **cansocket** in order to transmit and receive messages via the **slcan0** CAN bus adapter.

**arke** is the firmware on the arke board and represents a simple CAN bus manager. **arkedump** is a helper program on the host that allows to print the communication stream to the host console for debugging purposes. **cansend** (not shown) is another such program to directly send specific CAN messages by the user.

The firmware on the **zeus** board. It directly controls the humidifier, called **celeano**, in response to the tempereature and humidity sensor input from the **anemoi** board (not shown here, directly connected to zeus via an I2C bus).

**helios** is the illumination system. It emits visible and UV light, as well as IR flashes for the vision system. The IR trigger is received directly on the **helios master** from the frame grabber on the host PC (via a separate cable).
